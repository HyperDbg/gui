package libhyperdbg

import "github.com/winlabs/gowin32/wrappers"

var (
	PageSize                                                                              = 4096
	WcharMin                                                                              = 0
	WcharMax                                                                              = 65535
	MaxPath                                                                               = 260
	NullZero                                                                              = 0
	Null64Zero                                                                            = 0
	False                                                                                 = 0
	True                                                                                  = 1
	Upper56Bits                                                                           = uint64(0xffffffffffffff00)
	Upper48Bits                                                                           = uint64(0xffffffffffff0000)
	Upper32Bits                                                                           = uint64(0xffffffff00000000)
	Lower32Bits                                                                           = uint64(0x00000000ffffffff)
	Lower16Bits                                                                           = uint64(0x000000000000ffff)
	Lower8Bits                                                                            = uint64(0x00000000000000ff)
	SecondLower8Bits                                                                      = uint64(0x000000000000ff00)
	Upper48BitsAndLower8Bits                                                              = uint64(0xffffffffffff00ff)
	VersionMajor                                                                          = 0
	VersionMinor                                                                          = 9
	VersionPatch                                                                          = 1
	MaximumPacketsCapacity                                                                = 1000
	MaximumPacketsCapacityPriority                                                        = 50
	NormalPageSize                                                                        = 4096 // PAGE_SIZE
	PacketChunkSize                                                                       = NormalPageSize
	MaxSerialPacketSize                                                                   = 10 * NormalPageSize
	DbgPrintLimitation                                                                    = 512
	DebuggerEventTagStartSeed                                                             = 0x1000000
	DebuggerThreadDebuggingTagStartSeed                                                   = 0x1000000
	DebuggerOutputSourceTagStartSeed                                                      = 0x1
	DebuggerOutputSourceMaximumRemoteSourceForSingleEvent                                 = 0x5
	DebuggerScriptEngineMemcpyMovingBufferSize                                            = 64
	MaximumNumberOfInitialPreallocatedEptHooks                                            = 5
	MaximumRegularInstantEvents                                                           = 20
	MaximumBigInstantEvents                                                               = 0
	RegularInstantEventRequestedSafeBuffer                                                = PageSize
	BigInstantEventRequestedSafeBuffer                                                    = MaxSerialPacketSize
	DefaultPort                                                                           = "50000"
	CommunicationBufferSize                                                               = PacketChunkSize + 0x100
	TopLevelDriversVmcallStartingNumber                                                   = 0x00000200
	OperationMandatoryDebuggeeBit                                                         = 1 << 31
	OperationLogInfoMessage                                                               = 1
	OperationLogWarningMessage                                                            = 2
	OperationLogErrorMessage                                                              = 3
	OperationLogNonImmediateMessage                                                       = 4
	OperationLogWithTag                                                                   = 5
	MaximumBreakpointsWithoutContinue                                                     = 100
	MaximumNumberOfThreadInformationForTraps                                              = 200
	Pooltag                                                                               = 0x48444247 // [H]yper[DBG] (HDBG)
	SerialEndOfBufferCharsCount                                                           = 0x4
	SerialEndOfBufferChar1                                                                = 0x00
	SerialEndOfBufferChar2                                                                = 0x80
	SerialEndOfBufferChar3                                                                = 0xEE
	SerialEndOfBufferChar4                                                                = 0xFF
	TcpEndOfBufferCharsCount                                                              = 0x4
	TcpEndOfBufferChar1                                                                   = 0x10
	TcpEndOfBufferChar2                                                                   = 0x20
	TcpEndOfBufferChar3                                                                   = 0x33
	TcpEndOfBufferChar4                                                                   = 0x44
	MaximumCharacterForOsName                                                             = 256
	MaximumInstrSize                                                                      = 16
	MaximumCallInstrSize                                                                  = 7
	MaximumSupportedSymbols                                                               = 1000
	MaximumGuidAndAgeSize                                                                 = 60
	IndicatorOfHyperdbgPacket                                                             = 0x4859504552444247 // HYPERDBG = 0x4859504552444247
	MaximumSearchResults                                                                  = 0x1000
	X86FlagsCf                                                                            = 1 << 0
	X86FlagsPf                                                                            = 1 << 2
	X86FlagsAf                                                                            = 1 << 4
	X86FlagsZf                                                                            = 1 << 6
	X86FlagsSf                                                                            = 1 << 7
	X86FlagsTf                                                                            = 1 << 8
	X86FlagsIf                                                                            = 1 << 9
	X86FlagsDf                                                                            = 1 << 10
	X86FlagsOf                                                                            = 1 << 11
	X86FlagsStatusMask                                                                    = 0xfff
	X86FlagsIoplMask                                                                      = 3 << 12
	X86FlagsIoplShift                                                                     = 12
	X86FlagsIoplShift2NdBit                                                               = 13
	X86FlagsNt                                                                            = 1 << 14
	X86FlagsRf                                                                            = 1 << 16
	X86FlagsVm                                                                            = 1 << 17
	X86FlagsAc                                                                            = 1 << 18
	X86FlagsVif                                                                           = 1 << 19
	X86FlagsVip                                                                           = 1 << 20
	X86FlagsId                                                                            = 1 << 21
	X86FlagsReservedOnes                                                                  = 0x2
	X86FlagsReserved                                                                      = 0xffc0802a
	X86FlagsReservedBits                                                                  = 0xffc38028
	X86FlagsFixed                                                                         = 0x00000002
	MaxTempCount                                                                          = 128
	MaxStackBufferCount                                                                   = 128
	MaxVarCount                                                                           = 512
	MaxFunctionNameLength                                                                 = 32
	DebuggerModifyEventsApplyToAllTag                                                     = uint64(0xffffffffffffffff)
	DisassemblyMaximumDistanceFromObjectName                                              = 0xffff
	DebuggerReadAndWriteOnMsrApplyAllCores                                                = 0xffffffff
	DebuggerDebuggeeIsRunningNoCore                                                       = 0xffffffff
	DebuggerEventApplyToAllCores                                                          = 0xffffffff
	DebuggerEventApplyToAllProcesses                                                      = 0xffffffff
	DebuggerEventMsrReadOrWriteAllMsrs                                                    = 0xffffffff
	DebuggerEventExceptionsAllFirst32Entries                                              = 0xffffffff
	DebuggerEventSyscallAllSysretOrSyscalls                                               = 0xffffffff
	DebuggerEventAllIoPorts                                                               = 0xffffffff
	DebuggeeBpApplyToAllCores                                                             = 0xffffffff
	DebuggeeBpApplyToAllProcesses                                                         = 0xffffffff
	DebuggeeBpApplyToAllThreads                                                           = 0xffffffff
	DebuggeeShowAllRegisters                                                              = 0xffffffff
	DebuggerOperationWasSuccessful                                                        = 0xFFFFFFFF
	DebuggerErrorTagNotExists                                                             = 0xc0000000
	DebuggerErrorInvalidActionType                                                        = 0xc0000001
	DebuggerErrorActionBufferSizeIsZero                                                   = 0xc0000002
	DebuggerErrorEventTypeIsInvalid                                                       = 0xc0000003
	DebuggerErrorUnableToCreateEvent                                                      = 0xc0000004
	DebuggerErrorInvalidAddress                                                           = 0xc0000005
	DebuggerErrorInvalidCoreId                                                            = 0xc0000006
	DebuggerErrorExceptionIndexExceedFirst32Entries                                       = 0xc0000007
	DebuggerErrorInterruptIndexIsNotValid                                                 = 0xc0000008
	DebuggerErrorUnableToHideOrUnhideDebugger                                             = 0xc0000009
	DebuggerErrorDebuggerAlreadyUhide                                                     = 0xc000000a
	DebuggerErrorEditMemoryStatusInvalidParameter                                         = 0xc000000b
	DebuggerErrorEditMemoryStatusInvalidAddressBasedOnCurrentProcess                      = 0xc000000c
	DebuggerErrorEditMemoryStatusInvalidAddressBasedOnOtherProcess                        = 0xc000000d
	DebuggerErrorModifyEventsInvalidTag                                                   = 0xc000000e
	DebuggerErrorModifyEventsInvalidTypeOfAction                                          = 0xc000000f
	DebuggerErrorSteppingInvalidParameter                                                 = 0xc0000010
	DebuggerErrorSteppingsEitherThreadNotFoundOrDisabled                                  = 0xc0000011
	DebuggerErrorPreparingDebuggeeInvalidBaudrate                                         = 0xc0000012
	DebuggerErrorPreparingDebuggeeInvalidSerialPort                                       = 0xc0000013
	DebuggerErrorPreparingDebuggeeInvalidCoreInRemoteDebugge                              = 0xc0000014
	DebuggerErrorPreparingDebuggeeUnableToSwitchToNewProcess                              = 0xc0000015
	DebuggerErrorPreparingDebuggeeToRunScript                                             = 0xc0000016
	DebuggerErrorInvalidRegisterNumber                                                    = 0xc0000017
	DebuggerErrorMaximumBreakpointWithoutContinue                                         = 0xc0000018
	DebuggerErrorBreakpointAlreadyExistsOnTheAddress                                      = 0xc0000019
	DebuggerErrorBreakpointIdNotFound                                                     = 0xc000001a
	DebuggerErrorBreakpointAlreadyDisabled                                                = 0xc000001b
	DebuggerErrorBreakpointAlreadyEnabled                                                 = 0xc000001c
	DebuggerErrorMemoryTypeInvalid                                                        = 0xc000001d
	DebuggerErrorInvalidProcessId                                                         = 0xc000001e
	DebuggerErrorEventIsNotApplied                                                        = 0xc000001f
	DebuggerErrorDetailsOrSwitchProcessInvalidParameter                                   = 0xc0000020
	DebuggerErrorDetailsOrSwitchThreadInvalidParameter                                    = 0xc0000021
	DebuggerErrorMaximumBreakpointForASinglePageIsHit                                     = 0xc0000022
	DebuggerErrorPreAllocatedBufferIsEmpty                                                = 0xc0000023
	DebuggerErrorEptCouldNotSplitTheLargePageTo4KbPages                                   = 0xc0000024
	DebuggerErrorEptFailedToGetPml1EntryOfTargetAddress                                   = 0xc0000025
	DebuggerErrorEptMultipleHooksInASinglePage                                            = 0xc0000026
	DebuggerErrorCouldNotBuildTheEptHook                                                  = 0xc0000027
	DebuggerErrorCouldNotFindAllocationType                                               = 0xc0000028
	DebuggerErrorInvalidTestQueryIndex                                                    = 0xc0000029
	DebuggerErrorUnableToAttachToTargetUserModeProcess                                    = 0xc000002a
	DebuggerErrorUnableToRemoveHooksEntrypointNotReached                                  = 0xc000002b
	DebuggerErrorUnableToRemoveHooks                                                      = 0xc000002c
	DebuggerErrorFunctionsForInitializingPebAddressesAreNotInitialized                    = 0xc000002d
	DebuggerErrorUnableToDetect32BitOr64BitProcess                                        = 0xc000002e
	DebuggerErrorUnableToKillTheProcess                                                   = 0xc000002f
	DebuggerErrorInvalidThreadDebuggingToken                                              = 0xc0000030
	DebuggerErrorUnableToPauseTheProcessThreads                                           = 0xc0000031
	DebuggerErrorUnableToAttachToAnAlreadyAttachedProcess                                 = 0xc0000032
	DebuggerErrorTheUserDebuggerNotAttachedToTheProcess                                   = 0xc0000033
	DebuggerErrorUnableToDetachAsThereArePausedThreads                                    = 0xc0000034
	DebuggerErrorUnableToSwitchProcessIdOrThreadIdIsInvalid                               = 0xc0000035
	DebuggerErrorUnableToSwitchThereIsNoThreadOnTheProcess                                = 0xc0000036
	DebuggerErrorUnableToGetModulesOfTheProcess                                           = 0xc0000037
	DebuggerErrorUnableToGetCallstack                                                     = 0xc0000038
	DebuggerErrorUnableToQueryCountOfProcessesOrThreads                                   = 0xc0000039
	DebuggerErrorUsingShortCircuitingEventWithPostEventModeIsForbiddedn                   = 0xc000003a
	DebuggerErrorUnknownTestQueryReceived                                                 = 0xc000003b
	DebuggerErrorReadingMemoryInvalidParameter                                            = 0xc000003c
	DebuggerErrorTheTrapFlagListIsFull                                                    = 0xc000003d
	DebuggerErrorUnableToKillTheProcessDoesNotExists                                      = 0xc000003e
	DebuggerErrorModeExecutionIsInvalid                                                   = 0xc000003f
	DebuggerErrorProcessIdCannotBeSpecifiedWhileApplyingEventFromVmxRootMode              = 0xc0000040
	DebuggerErrorInstantEventPreallocatedBufferIsNotEnoughForEventAndConditionals         = 0xc0000041
	DebuggerErrorInstantEventRegularPreallocatedBufferNotFound                            = 0xc0000042
	DebuggerErrorInstantEventBigPreallocatedBufferNotFound                                = 0xc0000043
	DebuggerErrorUnableToCreateActionCannotAllocateBuffer                                 = 0xc0000044
	DebuggerErrorInstantEventActionRegularPreallocatedBufferNotFound                      = 0xc0000045
	DebuggerErrorInstantEventActionBigPreallocatedBufferNotFound                          = 0xc0000046
	DebuggerErrorInstantEventPreallocatedBufferIsNotEnoughForActionBuffer                 = 0xc0000047
	DebuggerErrorInstantEventRequestedOptionalBufferIsBiggerThanDebuggersSendReceiveStack = 0xc0000048
	DebuggerErrorInstantEventRegularRequestedSafeBufferNotFound                           = 0xc0000049
	DebuggerErrorInstantEventBigRequestedSafeBufferNotFound                               = 0xc000004a
	DebuggerErrorInstantEventPreallocatedBufferIsNotEnoughForRequestedSafeBuffer          = 0xc000004b
	DebuggerErrorUnableToAllocateRequestedSafeBuffer                                      = 0xc000004c
	DebuggerErrorCouldNotFindPreactivationType                                            = 0xc000004d
	DebuggerErrorTheModeExecTrapIsNotInitialized                                          = 0xc000004e
	DebuggerErrorTheTargetEventIsDisabledButCannotBeClearedPrirityBufferIsFull            = 0xc000004f
	DebuggerErrorNotAllCoresAreLockedForApplyingInstantEvent                              = 0xc0000050
	DebuggerErrorTargetSwitchingCoreIsNotLocked                                           = 0xc0000051
	DebuggerErrorInvalidPhysicalAddress                                                   = 0xc0000052
	DefaultInitialDebuggeeToDebuggerOffset                                                = 0x200
	DefaultInitialDebuggerToDebuggeeOffset                                                = 0x0
	IoctlRegisterEvent                                                                    = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x800, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlReturnIrpPendingPacketsAndDisallowIoctl                                          = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x801, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlTerminateVmx                                                                     = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x802, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerReadMemory                                                               = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x803, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerReadOrWriteMsr                                                           = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x804, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerReadPageTableEntriesDetails                                              = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x805, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerRegisterEvent                                                            = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x806, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerAddActionToEvent                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x807, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerHideAndUnhideToTransparentTheDebugger                                    = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x808, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerVa2PaAndPa2VaCommands                                                    = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x809, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerEditMemory                                                               = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80a, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerSearchMemory                                                             = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80b, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerModifyEvents                                                             = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80c, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerFlushLoggingBuffers                                                      = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80d, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerAttachDetachUserModeProcess                                              = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80e, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerPrint                                                                    = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x80f, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlPrepareDebuggee                                                                  = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x810, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlPausePacketReceived                                                              = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x811, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlSendSignalExecutionInDebuggeeFinished                                            = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x812, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlSendUsermodeMessagesToDebugger                                                   = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x813, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlSendGeneralBufferFromDebuggeeToDebugger                                          = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x814, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlPerfromKernelSideTests                                                           = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x815, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlReservePreAllocatedPools                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x816, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlSendUserDebuggerCommands                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x817, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlGetDetailOfActiveThreadsAndProcesses                                             = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x818, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlGetUserModeModuleDetails                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x819, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlQueryCountOfActiveProcessesOrThreads                                             = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81a, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlGetListOfThreadsAndProcesses                                                     = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81b, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlQueryCurrentProcess                                                              = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81c, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlQueryCurrentThread                                                               = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81d, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlRequestRevMachineService                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81e, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlDebuggerBringPagesIn                                                             = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x81f, METHOD_BUFFERED, FILE_ANY_ACCESS)
	IoctlPreactivateFunctionality                                                         = CTL_CODE(FILE_DEVICE_UNKNOWN, 0x820, METHOD_BUFFERED, FILE_ANY_ACCESS)
	DebuggerRemoteTrackingDefaultCountOfStepping                                          = 0xffffffff
)

func CTL_CODE(deviceType, function, method, access uint32) IoctlKind {
	return IoctlKind(((deviceType) << 16) | ((access) << 14) | ((function) << 2) | (method))
}

const (
	FILE_DEVICE_UNKNOWN = wrappers.FILE_DEVICE_UNKNOWN
	METHOD_BUFFERED     = wrappers.METHOD_BUFFERED
	FILE_ANY_ACCESS     = wrappers.FILE_ANY_ACCESS
)
